<html>
<head>
	<link type="text/css" href="jquery-ui-1.8.17.custom.css" rel="stylesheet" />
	<style type="text/css">
		canvas, img {display:block;margin:1em auto; border:1px solid black;}
		canvas { z-index:2;position:absolute;background:url(space.jpg) }
		.explosiondiv { z-index:60;position:absolute;background-image: url(explosion1.gif); height: 139px; width: 100px;}
		.game-wrap {position:relative;merging:0 auto;left:50%;width:800; height:600}
		.invis { display: none}
		#signup {display: none}
		#savescore {display: none}
		.inputtag { width:300px }
		.inputfield {width:300px}
	</style>
	<title>Adam Zeira and Shirly Biniashvili</title>
</head>
<body>
	<div id="game-wrap">

		<canvas id="gamecanvas" width="800" height="600" style="background-color:Red">
			Your browser does not support the canvas element

		</canvas>
		<div id="explosiondiv1" class="explosiondiv invis"></div>
		<div id="explosiondiv2" class="explosiondiv invis"></div>
        Sound <input type="checkbox" checked="checked" />
	</div>
<script src="socket.io.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
<script src="player.js"></script>
<script src="laser.js"></script>
<script src="subwebspacegame.js"></script>
<script src="asteroid.js"></script>


<div id="signup" title="Sign up">
	<div> To save your score, you can sign up</div>
	<div><span class='inputtag'>Name</span><input id="namefield" type="text" class="inputfield"></div>
	<div><span class='inputtag'>Email</span><input id="emailfield" type="text" class="inputfield"></div>
	<div><span class='inputtag'>Password</span><input id="passwordfield" type="text" class="inputfield"></div>
	<div><input class="signupsubmit" type="button" value="Sign up" onclick="postSignup()" /><input type="button" value="Back" onclick="cancelSignup()"></div>
</div>

<div id="savescore" title="Save score">
	<div>Your score:<span id="score"></span></div>
	<div><span class='inputtag'>Name</span><input id="scorenamefield" type="text" class="inputfield"></div>
	<div><input class="savescoresubmit" type="button" value="save" onclick="saveScore()" /></div>
</div>
<script>

jQuery(function () {
	jQuery('#signup').dialog({ autoOpen:false, resizable:false });
    jQuery('#savescore').dialog({ autoOpen:false, resizable:false });
});

var saveScore = function () {
    var form = jQuery("#savescore");
    var data = {
		name : form.find("#scorenamefield").val(),
	        score : game.playerScore
	};

//    jQuery.post("/savescore", data, function () { alert('success'); }).error(function (e) { alert('error'); });
    jQuery("#savescore").dialog('close');
//FIX, move to on success
	saveName(data.name);
};

var cancelSignup = function () {
	jQuery("#signup").dialog('close');
	showSaveScore();
};

var showSaveScore = function () {
	jQuery("#score").text(game.PlayerScore);
	jQuery("#savescore").dialog('open');
};

var showSignup = function () {
    jQuery("#signup").dialog('open');
	jQuery("#signup").find("#namefield").val(game.myPlayer.name);
};

var postSignup = function () {
	var form = jQuery("#signup");
	var data = {
		name : form.find("#namefield").val(),
		email : form.find("#emailfield").val(),
		password : form.find("#passwordfield").val()
	};

//	jQuery.post("/new", data, function () { alert('success'); }).error(function (e) { alert('error'); });
	//FIX
	//move to success
	saveName(data.name);
    //document.cookie = 'name=testcookie; expires=Thu, 2 Aug 2021 20:47:11 UTC; path=/'
	jQuery("#signup").dialog('close');

/*    var data2 = {
        name : data.name,
        score : game.PlayerScore
    };
    jQuery.post("/savescore", data2, function () { alert('success'); }).error(function (e) { alert('error'); });*/
};

var saveName = function (name) {
	game.nameChange(name);
	document.cookie = 'name=' + name;
	game.hascookie = true;
	game.saveScore(name);
};

</script>
</body></html>
